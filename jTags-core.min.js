(function(e){window.jTagSettings={execAllAfterJend:true,scopeSelector:"html"};e.fn.exec=function(){if(this.length==0)e(this).jTagError("cannot execute non-existing jTag");var t=e(this).first();var n=t.skip();if(!isNaN(n)){t.skip(n-1);e(t).trigger("skip");return"skip"}else if(n==="true"){e(t).trigger("skip");return"skip"}var r=t.prop("tagName").toLowerCase();var i={};var s=t.get(0).attributes;for(var o=0,u=s.length;o<u;o++)i[s[o].name]=s[o].value;var a=e.extend(t.data("jTag-data"),i);var f=jTags[r];if(e.isFunction(f)){t.trigger("beforeExec",a);f.call(t,a);t.attr("skip","true");e(window).trigger("afterExec",[r,a])}else e(t).jTagError("jTag `"+r+"` not found")};e.fn.execLayer=function(){var t=this;e(t).trigger("beforeExecLayer");var n="";for(var r in jTags){if(jTags.hasOwnProperty(r)){n+=r+","}}n=n.substr(0,n.length-1);e(t).find(n).each(function(t,r){if(e(r).parents(n).length==0)e(r).exec()});e(t).trigger("beforeExecLayer")};e.fn.execAll=function(){var t=this;e(t).trigger("beforeExecAll");var n="",r="a";while(n!==r){n=e(t).html();e(t).execLayer();r=e(t).html()}e(t).trigger("afterExecAll")};e.fn.jend=function(t){var n=this;var r=e(n).prop("tagName").toLowerCase();e(n).trigger("beforeJend",t);if(typeof t!=="undefined")e(n).html("").append(t);e(n).contents().unwrap();e(window).trigger("afterJend",[r,t]);if(jTagSettings.execAllAfterJend)e(jTagSettings.scopeSelector).execAll()};e.fn.skip=function(t){var n=this;var n=this;if(t){if(t==0)e(n).removeAttr("skip");else if(t=="once")e(n).attr("skip",1);else if(!isNaN(t))e(n).attr("skip",t);else if(t=="true")e(n).attr("skip","true");else e(n).jTagError("invalid value of `skip` attribute")}else return e(n).attr("skip")};e.fn.jTagError=function(e){var t={name:"jTags Error",jTag:this,message:e,htmlMessage:e,toString:function(){return this.name+": "+this.message}};throw t};window.jTags={"example-jtag":function(t){var n=this;console.log(t);if(t.ajaxurl)e.get(t.ajaxurl,function(t){e(n).jend(t)});else e(n).skip("once")}}})(jQuery)
